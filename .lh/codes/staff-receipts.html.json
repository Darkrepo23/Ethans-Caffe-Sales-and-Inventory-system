{
    "sourceFile": "codes/staff-receipts.html",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1772359264559,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1772372631305,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -142,17 +142,26 @@\n                 <div class=\"row\">\r\n                     <!-- Transactions Table -->\r\n                     <div class=\"col-lg-7 mb-4\">\r\n                         <div class=\"card shadow\">\r\n-                            <div class=\"card-header bg-black text-white\">\r\n+                            <div class=\"card-header bg-black text-white d-flex justify-content-between align-items-center\">\r\n                                 <h6 class=\"m-0 font-weight-bold\"><i class=\"fas fa-history me-1\"></i>Today's\r\n                                     Transactions</h6>\r\n+                                <div class=\"btn-group btn-group-sm\">\r\n+                                    <button class=\"btn btn-outline-light\" id=\"deleteSelectedBtn\" onclick=\"deleteSelectedReceipts()\" disabled>\r\n+                                        <i class=\"fas fa-trash-alt me-1\"></i>Delete Selected\r\n+                                    </button>\r\n+                                    <button class=\"btn btn-outline-danger\" id=\"deleteAllBtn\" onclick=\"deleteAllReceipts()\">\r\n+                                        <i class=\"fas fa-trash me-1\"></i>Delete All\r\n+                                    </button>\r\n+                                </div>\r\n                             </div>\r\n                             <div class=\"card-body p-0\">\r\n                                 <div class=\"table-responsive\" style=\"max-height: 500px; overflow-y: auto;\">\r\n                                     <table class=\"table table-hover table-striped mb-0\" id=\"transactionsTable\">\r\n                                         <thead class=\"table-dark sticky-top\">\r\n                                             <tr>\r\n+                                                <th style=\"width: 40px;\"><input type=\"checkbox\" id=\"selectAllReceipts\" onclick=\"toggleSelectAllReceipts()\" class=\"form-check-input\"></th>\r\n                                                 <th>Ref #</th>\r\n                                                 <th>Time</th>\r\n                                                 <th>Items</th>\r\n                                                 <th>Total</th>\r\n@@ -161,9 +170,9 @@\n                                             </tr>\r\n                                         </thead>\r\n                                         <tbody id=\"receiptsList\">\r\n                                             <tr>\r\n-                                                <td colspan=\"6\" class=\"text-center py-5\">\r\n+                                                <td colspan=\"7\" class=\"text-center py-5\">\r\n                                                     <div class=\"spinner-border text-maroon\" role=\"status\"></div>\r\n                                                     <p class=\"mt-2 text-muted mb-0\">Loading transactions...</p>\r\n                                                 </td>\r\n                                             </tr>\r\n@@ -240,19 +249,17 @@\n                     \r\n                     <hr>\r\n                     \r\n                     <!-- Items List -->\r\n-                    <h6 class=\"fw-bold mb-3\"><i class=\"fas fa-list me-2\"></i>Transaction Items <small class=\"text-muted\" id=\"itemSelectionHint\" style=\"display: none;\">(Select items to refund)</small></h6>\r\n+                    <h6 class=\"fw-bold mb-3\"><i class=\"fas fa-list me-2\"></i>Transaction Items <small class=\"text-muted\" id=\"itemSelectionHint\" style=\"display: none;\">(Adjust qty to refund)</small></h6>\r\n                     <div class=\"table-responsive mb-3\" style=\"max-height: 200px; overflow-y: auto;\">\r\n                         <table class=\"table table-sm table-bordered\" id=\"txnItemsTable\">\r\n                             <thead class=\"table-light\">\r\n                                 <tr>\r\n-                                    <th style=\"width: 40px;\" id=\"selectAllHeader\" class=\"d-none\">\r\n-                                        <input type=\"checkbox\" class=\"form-check-input\" id=\"selectAllItems\" title=\"Select All\">\r\n-                                    </th>\r\n                                     <th>Item</th>\r\n-                                    <th style=\"width: 80px;\">Qty</th>\r\n-                                    <th style=\"width: 100px;\">Price</th>\r\n+                                    <th style=\"width: 70px;\">Qty</th>\r\n+                                    <th style=\"width: 90px;\" id=\"refundQtyHeader\" class=\"d-none text-center bg-warning-subtle\">Refund</th>\r\n+                                    <th style=\"width: 90px;\">Price</th>\r\n                                     <th style=\"width: 100px;\">Subtotal</th>\r\n                                 </tr>\r\n                             </thead>\r\n                             <tbody id=\"txnItemsList\">\r\n"
                }
            ],
            "date": 1772359264559,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Receipts - Staff Dashboard</title>\r\n\r\n    <!-- Bootstrap 5 CSS -->\r\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\r\n    <!-- Font Awesome -->\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\r\n    <!-- Animate.css -->\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css\">\r\n\r\n    <!-- Custom CSS -->\r\n    <link rel=\"stylesheet\" href=\"style.css\">\r\n    <link rel=\"stylesheet\" href=\"staff.css\">\r\n    <script>\r\n        // Immediate Sidebar State Initialization\r\n        (function () {\r\n            const html = document.documentElement;\r\n            html.classList.add('initializing');\r\n\r\n            const sidebarState = localStorage.getItem('sidebarActive');\r\n            if (sidebarState === 'true' && window.innerWidth >= 992) {\r\n                html.classList.add('sidebar-active');\r\n            }\r\n\r\n            // Auth Guard (Staff/Cashier version)\r\n            try {\r\n                const role = localStorage.getItem('loggedInRole');\r\n                if (role !== 'staff' && role !== 'cashier') {\r\n                    window.location.href = 'index.html';\r\n                }\r\n            } catch (e) {\r\n                window.location.href = 'index.html';\r\n            }\r\n        })();\r\n    </script>\r\n</head>\r\n\r\n<body>\r\n    <!-- Navigation Bar -->\r\n    <nav class=\"navbar navbar-expand-lg navbar-dark bg-black fixed-top shadow\">\r\n        <div class=\"container-fluid\">\r\n            <button class=\"sidebar-toggle mt-1 me-2\" id=\"sidebarToggle\">\r\n                <i class=\"fas fa-bars\"></i>\r\n            </button>\r\n\r\n            <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#headerNav\">\r\n                <span class=\"fas fa-ellipsis-v\"></span>\r\n            </button>\r\n            <div class=\"collapse navbar-collapse\" id=\"headerNav\">\r\n                <ul class=\"navbar-nav ms-auto\">\r\n                    <li class=\"nav-item dropdown\">\r\n                        <a class=\"nav-link dropdown-toggle\" href=\"#\" role=\"button\" data-bs-toggle=\"dropdown\">\r\n                            <i class=\"fas fa-user-circle me-1\"></i>John Doe\r\n                        </a>\r\n                        <ul class=\"dropdown-menu dropdown-menu-end shadow border-0 animate__animated animate__fadeIn\">\r\n                            <li><a class=\"dropdown-item\" href=\"staff-account.html\"><i\r\n                                        class=\"fas fa-user-cog me-2 text-maroon\"></i>Account</a></li>\r\n                            <li><a class=\"dropdown-item\" href=\"staff-activity.html\"><i\r\n                                        class=\"fas fa-history me-2 text-maroon\"></i>Activity Log</a></li>\r\n                            <li>\r\n                                <hr class=\"dropdown-divider\">\r\n                            </li>\r\n                            <li><a class=\"dropdown-item text-danger\" href=\"#\" id=\"logoutBtn\"><i\r\n                                        class=\"fas fa-sign-out-alt me-2\"></i>Logout</a></li>\r\n                        </ul>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </nav>\r\n\r\n    <div class=\"dashboard-layout\">\r\n        <!-- Sidebar Navigation -->\r\n        <aside class=\"sidebar\" id=\"sidebar\">\r\n            <div class=\"sidebar-branding\">\r\n                <button class=\"sidebar-toggle in-sidebar\" id=\"sidebarToggleInternal\">\r\n                    <i class=\"fas fa-bars\"></i>\r\n                </button>\r\n                <a href=\"staff-dashboard.html\" class=\"sidebar-brand-group\">\r\n                    <img src=\"resources/ethans logo.jpg\" alt=\"Logo\">\r\n                    <span class=\"pos-label\">POS</span>\r\n                </a>\r\n            </div>\r\n            <div class=\"sidebar-nav\">\r\n                <div class=\"sidebar-section-title\">Operations</div>\r\n                <a href=\"staff-menu.html\" class=\"sidebar-link\">\r\n                    <i class=\"fas fa-utensils\"></i>Menu Sales\r\n                </a>\r\n                <a href=\"staff-held-orders.html\" class=\"sidebar-link\">\r\n                    <i class=\"fas fa-pause-circle\"></i>Held Orders\r\n                </a>\r\n                <a href=\"staff-ingredients.html\" class=\"sidebar-link\">\r\n                    <i class=\"fas fa-boxes\"></i>Ingredients\r\n                </a>\r\n                <a href=\"staff-receipts.html\" class=\"sidebar-link active\">\r\n                    <i class=\"fas fa-receipt\"></i>Receipts\r\n                </a>\r\n\r\n                <div class=\"sidebar-divider\"></div>\r\n                <div class=\"sidebar-section-title\">Account</div>\r\n                <a href=\"staff-account.html\" class=\"sidebar-link\">\r\n                    <i class=\"fas fa-user-cog\"></i>Account Settings\r\n                </a>\r\n                <a href=\"staff-activity.html\" class=\"sidebar-link\">\r\n                    <i class=\"fas fa-history\"></i>My Activity\r\n                </a>\r\n            </div>\r\n        </aside>\r\n\r\n        <!-- Main Content Area -->\r\n        <main class=\"main-content\">\r\n            <!-- Receipts Content -->\r\n            <div id=\"receipts-content\" class=\"page-content\">\r\n                <div\r\n                    class=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom\">\r\n                    <h1 class=\"h2\"><i class=\"fas fa-receipt me-2 text-maroon\"></i>Sales Receipts</h1>\r\n\r\n                </div>\r\n\r\n                <!-- Date Filter -->\r\n                <div class=\"row mb-4\">\r\n                    <div class=\"col-md-5 mb-3\">\r\n                        <label class=\"form-label small text-muted text-uppercase fw-bold\">From Date</label>\r\n                        <input type=\"date\" class=\"form-control\" id=\"receiptDateFrom\">\r\n                    </div>\r\n                    <div class=\"col-md-5 mb-3\">\r\n                        <label class=\"form-label small text-muted text-uppercase fw-bold\">To Date</label>\r\n                        <input type=\"date\" class=\"form-control\" id=\"receiptDateTo\">\r\n                    </div>\r\n                    <div class=\"col-md-2 mb-3 d-flex align-items-end\">\r\n                        <button class=\"btn btn-maroon w-100\" id=\"filterReceipts\">\r\n                            <i class=\"fas fa-filter\"></i>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"row\">\r\n                    <!-- Transactions Table -->\r\n                    <div class=\"col-lg-7 mb-4\">\r\n                        <div class=\"card shadow\">\r\n                            <div class=\"card-header bg-black text-white\">\r\n                                <h6 class=\"m-0 font-weight-bold\"><i class=\"fas fa-history me-1\"></i>Today's\r\n                                    Transactions</h6>\r\n                            </div>\r\n                            <div class=\"card-body p-0\">\r\n                                <div class=\"table-responsive\" style=\"max-height: 500px; overflow-y: auto;\">\r\n                                    <table class=\"table table-hover table-striped mb-0\" id=\"transactionsTable\">\r\n                                        <thead class=\"table-dark sticky-top\">\r\n                                            <tr>\r\n                                                <th>Ref #</th>\r\n                                                <th>Time</th>\r\n                                                <th>Items</th>\r\n                                                <th>Total</th>\r\n                                                <th>Status</th>\r\n                                                <th>Actions</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody id=\"receiptsList\">\r\n                                            <tr>\r\n                                                <td colspan=\"6\" class=\"text-center py-5\">\r\n                                                    <div class=\"spinner-border text-maroon\" role=\"status\"></div>\r\n                                                    <p class=\"mt-2 text-muted mb-0\">Loading transactions...</p>\r\n                                                </td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- Receipt Preview -->\r\n                    <div class=\"col-lg-5 mb-4\">\r\n                        <div class=\"card shadow sticky-top\" style=\"top: 85px;\">\r\n                            <div class=\"card-header bg-maroon text-white\">\r\n                                <h6 class=\"m-0 font-weight-bold\"><i class=\"fas fa-eye me-1\"></i>Receipt Preview</h6>\r\n                            </div>\r\n                            <div class=\"card-body\">\r\n                                <div id=\"receiptPreview\"\r\n                                    class=\"border p-4 bg-light text-monospace rounded shadow-sm mb-3\">\r\n                                    <p class=\"text-center text-muted py-5 mt-3 mb-5\">Select a transaction to view\r\n                                        receipt preview</p>\r\n                                </div>\r\n                                <div class=\"d-grid gap-2\">\r\n                                    <button class=\"btn btn-maroon\" id=\"printReceiptBtn\" disabled>\r\n                                        <i class=\"fas fa-print me-2\"></i>Print Receipt\r\n                                    </button>\r\n                                    <button class=\"btn btn-outline-secondary\" id=\"newSaleFromReceiptBtn\" disabled>\r\n                                        <i class=\"fas fa-cart-plus me-2\"></i>New Sale from This\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </main>\r\n    </div>\r\n\r\n    <!-- Transaction Refund/Void Modal -->\r\n    <div class=\"modal fade\" id=\"transactionEditModal\" tabindex=\"-1\" aria-labelledby=\"transactionEditModalLabel\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog modal-lg\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header bg-warning text-dark\">\r\n                    <h5 class=\"modal-title\" id=\"transactionEditModalLabel\">\r\n                        <i class=\"fas fa-undo me-2\"></i>Refund / Void Transaction\r\n                    </h5>\r\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <input type=\"hidden\" id=\"editTransactionId\">\r\n                    \r\n                    <!-- Transaction Info -->\r\n                    <div class=\"row mb-3\">\r\n                        <div class=\"col-md-6\">\r\n                            <label class=\"form-label small text-muted text-uppercase fw-bold\">Reference #</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"txnReference\" readonly>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <label class=\"form-label small text-muted text-uppercase fw-bold\">Original Total</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"txnOriginalTotal\" readonly>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"row mb-3\">\r\n                        <div class=\"col-md-6\">\r\n                            <label class=\"form-label small text-muted text-uppercase fw-bold\">Date/Time</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"txnDateTime\" readonly>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <label class=\"form-label small text-muted text-uppercase fw-bold\">Staff</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"txnStaff\" readonly>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <hr>\r\n                    \r\n                    <!-- Items List -->\r\n                    <h6 class=\"fw-bold mb-3\"><i class=\"fas fa-list me-2\"></i>Transaction Items <small class=\"text-muted\" id=\"itemSelectionHint\" style=\"display: none;\">(Select items to refund)</small></h6>\r\n                    <div class=\"table-responsive mb-3\" style=\"max-height: 200px; overflow-y: auto;\">\r\n                        <table class=\"table table-sm table-bordered\" id=\"txnItemsTable\">\r\n                            <thead class=\"table-light\">\r\n                                <tr>\r\n                                    <th style=\"width: 40px;\" id=\"selectAllHeader\" class=\"d-none\">\r\n                                        <input type=\"checkbox\" class=\"form-check-input\" id=\"selectAllItems\" title=\"Select All\">\r\n                                    </th>\r\n                                    <th>Item</th>\r\n                                    <th style=\"width: 80px;\">Qty</th>\r\n                                    <th style=\"width: 100px;\">Price</th>\r\n                                    <th style=\"width: 100px;\">Subtotal</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody id=\"txnItemsList\">\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                    \r\n                    <!-- Refund Summary (for partial) -->\r\n                    <div class=\"alert alert-warning d-none\" id=\"refundSummaryAlert\">\r\n                        <div class=\"d-flex justify-content-between align-items-center\">\r\n                            <span><i class=\"fas fa-calculator me-2\"></i>Refund Amount:</span>\r\n                            <strong id=\"calculatedRefundAmount\">â‚±0.00</strong>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <hr>\r\n                    \r\n                    <!-- Action Type -->\r\n                    <div class=\"row mb-3\">\r\n                        <div class=\"col-md-12\">\r\n                            <label class=\"form-label small text-muted text-uppercase fw-bold\">Action Type</label>\r\n                            <select class=\"form-select\" id=\"txnActionType\">\r\n                                <option value=\"\">-- Select Action --</option>\r\n                                <option value=\"refund\">Refund (Full) - Refund entire transaction</option>\r\n                                <option value=\"partial_refund\">Partial Refund - Select items to refund</option>\r\n                                <option value=\"void\">Void Transaction - Cancel entire sale</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row mb-3 d-none\" id=\"adjustedTotalContainer\">\r\n                        <div class=\"col-md-6\">\r\n                            <!-- Hidden input to store calculated refund amount -->\r\n                            <input type=\"hidden\" id=\"txnAdjustedTotal\" value=\"0\">\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"mb-3\">\r\n                        <label class=\"form-label small text-muted text-uppercase fw-bold\">Reason <span class=\"text-danger\">*</span></label>\r\n                        <textarea class=\"form-control\" id=\"txnAdjustmentReason\" rows=\"3\" placeholder=\"Enter reason for refund/void...\" required></textarea>\r\n                    </div>\r\n                    \r\n                    <!-- Current Status Display -->\r\n                    <div class=\"alert alert-info d-none\" id=\"txnCurrentStatusAlert\">\r\n                        <i class=\"fas fa-info-circle me-2\"></i>\r\n                        <span id=\"txnCurrentStatusText\"></span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\r\n                    <button type=\"button\" class=\"btn btn-warning\" id=\"saveTransactionAdjustment\">\r\n                        <i class=\"fas fa-save me-1\"></i> Save Adjustment\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Bootstrap 5 JS Bundle with Popper -->\r\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js\"></script>\r\n    <script src=\"https://code.jquery.com/jquery-3.6.4.min.js\"></script>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/sweetalert2@11\"></script>\r\n\r\n    <script src=\"main.js\"></script>\r\n    <script src=\"staff.js\"></script>\r\n\r\n    <script>\r\n        // Centralized logic handles these features\r\n    </script>\r\n</body>\r\n\r\n</html>"
        }
    ]
}